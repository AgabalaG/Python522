<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Выполненные задачи пользователей</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f5f7fa;
            color: #333;
            line-height: 1.6;
            padding: 20px;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
            background-color: white;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }
        
        header {
            background-color: #4a6ee0;
            color: white;
            padding: 20px;
            text-align: center;
        }
        
        h1 {
            font-size: 24px;
            margin-bottom: 10px;
        }
        
        .controls {
            padding: 20px;
            background-color: #f0f4ff;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid #e0e6ff;
        }
        
        button {
            background-color: #4a6ee0;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            transition: background-color 0.3s;
        }
        
        button:hover {
            background-color: #3a5ec8;
        }
        
        .search-container {
            display: flex;
            gap: 10px;
        }
        
        input {
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
        }
        
        .tasks-container {
            max-height: 500px;
            overflow-y: auto;
            padding: 0;
        }
        
        .user-section {
            margin-bottom: 10px;
        }
        
        .user-header {
            background-color: #e8edff;
            padding: 12px 20px;
            font-weight: bold;
            border-bottom: 1px solid #d0d9ff;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .user-header:hover {
            background-color: #d8e1ff;
        }
        
        .user-tasks {
            display: none;
            padding: 0;
        }
        
        .user-tasks.active {
            display: block;
        }
        
        .task-item {
            padding: 12px 20px;
            border-bottom: 1px solid #f0f0f0;
            display: flex;
            align-items: center;
        }
        
        .task-item:nth-child(even) {
            background-color: #f9faff;
        }
        
        .task-number {
            background-color: #4a6ee0;
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 15px;
            font-weight: bold;
            flex-shrink: 0;
        }
        
        .task-title {
            flex-grow: 1;
        }
        
        .empty-state {
            text-align: center;
            padding: 40px 20px;
            color: #888;
        }
        
        .stats {
            padding: 15px 20px;
            background-color: #f0f4ff;
            border-top: 1px solid #e0e6ff;
            display: flex;
            justify-content: space-between;
            font-size: 14px;
        }
        
        @media (max-width: 600px) {
            .controls {
                flex-direction: column;
                gap: 15px;
            }
            
            .search-container {
                width: 100%;
            }
            
            input {
                flex-grow: 1;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Выполненные задачи пользователей</h1>
        </header>
        
        <div class="controls">
            <button id="load-users">Загрузить пользователей</button>
            <div class="search-container">
                <input type="text" id="search-input" placeholder="Поиск по задачам...">
                <button id="search-btn">Найти</button>
            </div>
        </div>
        
        <div class="tasks-container" id="tasks-container">
            <div class="empty-state" id="empty-state">
                Нажмите "Загрузить пользователей" для отображения данных
            </div>
        </div>
        
        <div class="stats">
            <div>Всего пользователей: <span id="total-users">0</span></div>
            <div>Всего задач: <span id="total-tasks">0</span></div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const loadUsersBtn = document.getElementById('load-users');
            const searchInput = document.getElementById('search-input');
            const searchBtn = document.getElementById('search-btn');
            const tasksContainer = document.getElementById('tasks-container');
            const emptyState = document.getElementById('empty-state');
            const totalUsersSpan = document.getElementById('total-users');
            const totalTasksSpan = document.getElementById('total-tasks');
            
            // Пример данных (в реальном приложении данные будут загружаться с сервера)
            const tasksData = [
                { userId: 1, taskId: 4, title: "et porro tempora" },
                { userId: 1, taskId: 8, title: "quo adipisci enim quam ut ab" },
                { userId: 1, taskId: 10, title: "illo est ratione doloremque quia maiores aut" },
                { userId: 1, taskId: 11, title: "vero rerum temporibus dolor" },
                { userId: 1, taskId: 12, title: "ipsa repellendus fugit nisi" },
                { userId: 1, taskId: 14, title: "repellendus sunt dolores architecto voluptatum" },
                { userId: 1, taskId: 15, title: "ab voluptatum amet voluptas" },
                { userId: 1, taskId: 16, title: "accusamus eos facilis sint et aut voluptatem" },
                { userId: 1, taskId: 17, title: "quo laboriosam deleniti aut qui" },
                { userId: 1, taskId: 19, title: "molestiae ipsa aut voluptatibus pariatur dolor nihil" },
                { userId: 1, taskId: 20, title: "ullam nobis libero sapiente ad optio sint" },
                { userId: 2, taskId: 22, title: "distinctio vitae autem nihil ut molestias quo" },
                { userId: 2, taskId: 25, title: "voluptas quo tenetur perspiciatis explicabo natus" },
                { userId: 2, taskId: 26, title: "aliquam aut quasi" },
                { userId: 2, taskId: 27, title: "veritatis pariatur delectus" },
                { userId: 2, taskId: 30, title: "nemo perspiciatis repellat ut dolor libero commodi blanditis omnis" },
                { userId: 2, taskId: 35, title: "repellendus veritatis molestias dicta incidunt" },
                { userId: 2, taskId: 36, title: "excepturi deleniti adipisci voluptatem et neque optio illum ad" },
                { userId: 2, taskId: 40, title: "totam atque quo nesciunt" },
                { userId: 3, taskId: 43, title: "temporo ut sint quis recusandae" },
                { userId: 3, taskId: 44, title: "cum debitis quis accusamus doloremque ipsa natus sapiente omnis" },
                { userId: 3, taskId: 50, title: "cupiditate necessitatibus villam aut quis dolor voluptate" },
                { userId: 3, taskId: 54, title: "quis et est ut voluptate quam dolor" },
                { userId: 3, taskId: 55, title: "voluptatum omnis minima qui occaecati provident nulla voluptatem ratione" },
                { userId: 3, taskId: 56, title: "deleniti ea temporibus enim" },
                { userId: 3, taskId: 60, title: "et sequi qui architecto ut adipisci" },
                { userId: 4, taskId: 61, title: "odit optio omnis qui sunt" },
                { userId: 4, taskId: 63, title: "doloremque aut dolores quidem fuga qui nulla" },
                { userId: 4, taskId: 73, title: "sint amet quia totam corporis qui exercitationem commodi" },
                { userId: 4, taskId: 76, title: "sequi dolorem sed" },
                { userId: 4, taskId: 79, title: "eum ipsa maxime ut" },
                { userId: 4, taskId: 80, title: "tempore molestias dolores rerum sequi voluptates ipsum consequatur" },
                { userId: 5, taskId: 81, title: "suscipit qui totam" },
                { userId: 5, taskId: 83, title: "quidem at rerum quis ex aut sit quam" },
                { userId: 5, taskId: 85, title: "et quia ad iste a" },
                { userId: 5, taskId: 86, title: "incidunt ut saepe autem" },
                { userId: 5, taskId: 87, title: "laudantium quae eligendi consequatur quia et vero autem" },
                { userId: 5, taskId: 89, title: "sequi ut omnis et" }
            ];
            
            // Группировка задач по пользователям
            function groupTasksByUser(tasks) {
                const grouped = {};
                tasks.forEach(task => {
                    if (!grouped[task.userId]) {
                        grouped[task.userId] = [];
                    }
                    grouped[task.userId].push(task);
                });
                return grouped;
            }
            
            // Отображение задач на странице
            function displayTasks(tasks) {
                tasksContainer.innerHTML = '';
                
                if (tasks.length === 0) {
                    emptyState.style.display = 'block';
                    tasksContainer.appendChild(emptyState);
                    return;
                }
                
                emptyState.style.display = 'none';
                
                const groupedTasks = groupTasksByUser(tasks);
                const userIds = Object.keys(groupedTasks).sort();
                
                userIds.forEach(userId => {
                    const userSection = document.createElement('div');
                    userSection.className = 'user-section';
                    
                    const userHeader = document.createElement('div');
                    userHeader.className = 'user-header';
                    userHeader.innerHTML = `
                        <span>Пользователь ${userId}</span>
                        <span>${groupedTasks[userId].length} задач</span>
                    `;
                    
                    const userTasks = document.createElement('div');
                    userTasks.className = 'user-tasks';
                    
                    groupedTasks[userId].forEach(task => {
                        const taskItem = document.createElement('div');
                        taskItem.className = 'task-item';
                        taskItem.innerHTML = `
                            <div class="task-number">${task.taskId}</div>
                            <div class="task-title">${task.title}</div>
                        `;
                        userTasks.appendChild(taskItem);
                    });
                    
                    userHeader.addEventListener('click', function() {
                        userTasks.classList.toggle('active');
                    });
                    
                    userSection.appendChild(userHeader);
                    userSection.appendChild(userTasks);
                    tasksContainer.appendChild(userSection);
                });
                
                // Обновление статистики
                totalUsersSpan.textContent = userIds.length;
                totalTasksSpan.textContent = tasks.length;
            }
            
            // Поиск задач
            function searchTasks(query) {
                if (!query.trim()) {
                    return tasksData;
                }
                
                const lowerQuery = query.toLowerCase();
                return tasksData.filter(task => 
                    task.title.toLowerCase().includes(lowerQuery) || 
                    task.taskId.toString().includes(query)
                );
            }
            
            // Обработчики событий
            loadUsersBtn.addEventListener('click', function() {
                displayTasks(tasksData);
            });
            
            searchBtn.addEventListener('click', function() {
                const query = searchInput.value;
                const filteredTasks = searchTasks(query);
                displayTasks(filteredTasks);
            });
            
            searchInput.addEventListener('keyup', function(event) {
                if (event.key === 'Enter') {
                    const query = searchInput.value;
                    const filteredTasks = searchTasks(query);
                    displayTasks(filteredTasks);
                }
            });
        });
    </script>
</body>
</html>